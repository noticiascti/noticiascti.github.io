<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ransom & Vulnerabilidades — iSecurity</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .card { background: #111827; border-radius: 8px; padding: 18px; border: 1px solid #1f2937; }
    table.compact th, table.compact td { padding: 10px 8px; border-bottom: 1px dashed rgba(255,255,255,0.08); color:#e5e7eb; }
    table.compact thead th { background:#0f1724; color:#cbd5e1; font-weight:600; font-size:13px; }
    .btn { background:#111827; border:1px solid #374151; color:#e5e7eb; padding:6px 10px; border-radius:6px; font-size:13px; }
    .flag { width:20px; height:14px; object-fit:cover; border-radius:2px; margin-right:6px; vertical-align:middle; }
  </style>
</head>
<body class="bg-gray-900 text-gray-200">

  <!-- Header -->
  <header class="bg-gray-950 p-4 shadow-md border-b border-gray-700 flex items-center space-x-3 cursor-pointer" onclick="window.location.href='/index.html'">
    <img src="https://isecurityqa.com/wp-content/uploads/2025/03/isecurity_logo-c.png" alt="iSecurity Logo" class="h-8">
    <h1 class="text-2xl font-bold text-yellow-400">Ransom & Vulnerabilidades</h1>
  </header>

  <!-- Menú superior -->
  <nav class="bg-gray-950 border-b border-gray-700">
    <ul class="flex flex-col md:flex-row md:space-x-6 p-4 md:p-2">
      <li><a href="/index.html" class="hover:text-yellow-400">🏠 Inicio</a></li>
      <li class="relative group">
        <button class="hover:text-yellow-400 flex items-center">🔒 Noticias Ciberseguridad ▾</button>
        <ul class="absolute hidden group-hover:block bg-gray-900 border border-gray-700 mt-2 rounded-lg w-56 z-50">
          <li><a href="/index.html#incidentes" class="block px-4 py-2 hover:bg-yellow-500 hover:text-black">💥 Incidentes & DataBreach</a></li>
          <li><a href="/index.html#tendencias" class="block px-4 py-2 hover:bg-yellow-500 hover:text-black">📊 Tendencias</a></li>
          <li><a href="/index.html#locales" class="block px-4 py-2 hover:bg-yellow-500 hover:text-black">🇨🇱 Noticias Locales</a></li>
          <li><a href="/index.html#prevencion" class="block px-4 py-2 hover:bg-yellow-500 hover:text-black">💡 Innovación & Prevención</a></li>
        </ul>
      </li>
      <li><a href="/medios.html" class="hover:text-yellow-400">📰 Medios Nacionales</a></li>
      <li><a href="/status.html" class="hover:text-yellow-400">📊 Status</a></li>
      <li><a href="/ransom_vulnerabilidades.html" class="text-yellow-400 font-semibold">⚡ Ransom & Vulnerabilidades</a></li>
      <li><a href="/reclamos.html" class="hover:text-yellow-400">📣 Reclamos</a></li>
    </ul>
  </nav>

  <!-- Main -->
  <main class="p-6 grid grid-cols-1 lg:grid-cols-12 gap-6">

    <!-- LEFT COLUMN -->
    <section class="lg:col-span-6 space-y-6">
      
      <!-- CISA -->
      <div class="card">
        <h2 class="text-yellow-400 font-semibold mb-4">🛡️ CISA - Known Exploited Vulnerabilities</h2>
        <div class="overflow-x-auto">
          <table class="w-full compact">
            <thead><tr><th>Fecha</th><th>CVE</th><th>Vendor</th><th>Producto</th><th>Descripción</th></tr></thead>
            <tbody id="cisa-body"></tbody>
          </table>
        </div>
        <div class="flex justify-between mt-2">
          <button id="cisa-prev" class="btn">◀</button>
          <button id="cisa-next" class="btn">▶</button>
        </div>
      </div>

      <!-- CVEMON -->
      <div class="card">
        <h2 class="text-yellow-400 font-semibold mb-4">🌍 CVEMON - Tendencias y Vulnerabilidades Activas</h2>
        <div class="overflow-x-auto">
          <table class="w-full compact">
            <thead><tr><th>Fecha</th><th>CVE</th><th>Descripción</th></tr></thead>
            <tbody id="cvemon-body"></tbody>
          </table>
        </div>
        <div class="flex justify-between mt-2">
          <button id="cvemon-prev" class="btn">◀</button>
          <button id="cvemon-next" class="btn">▶</button>
        </div>
      </div>

      <!-- INCIBE -->
      <div class="card">
        <h2 class="text-yellow-400 font-semibold mb-4">🇪🇸 INCIBE-CERT - Vulnerabilidades Recientes</h2>
        <div class="overflow-x-auto">
          <table class="w-full compact">
            <thead><tr><th>Fecha</th><th>CVE</th><th>Descripción</th></tr></thead>
            <tbody id="incibe-body"></tbody>
          </table>
        </div>
        <div class="flex justify-between mt-2">
          <button id="incibe-prev" class="btn">◀</button>
          <button id="incibe-next" class="btn">▶</button>
        </div>
      </div>

    </section>

    <!-- RIGHT COLUMN -->
    <aside class="lg:col-span-6 card">
      <h2 class="text-yellow-400 font-semibold mb-4">🦠 Ransomware - Víctimas</h2>

      <!-- GLOBAL -->
      <div class="mb-4">
        <h3 class="text-blue-300 font-semibold mb-2">🌐 Global</h3>
        <table class="w-full compact"><thead><tr><th>Fecha</th><th>Víctima</th><th>País</th><th>Grupo</th></tr></thead>
          <tbody id="ransom-global"></tbody>
        </table>
        <div class="flex justify-between mt-2">
          <button id="r-global-prev" class="btn">◀</button>
          <button id="r-global-next" class="btn">▶</button>
        </div>
      </div>

      <!-- LATAM -->
      <div>
        <h3 class="text-cyan-300 font-semibold mb-2">🌎 LATAM</h3>
        <table class="w-full compact"><thead><tr><th>Fecha</th><th>Víctima</th><th>País</th><th>Grupo</th></tr></thead>
          <tbody id="ransom-latam"></tbody>
        </table>
        <div class="flex justify-between mt-2">
          <button id="r-latam-prev" class="btn">◀</button>
          <button id="r-latam-next" class="btn">▶</button>
        </div>
      </div>
    </aside>

  </main>

  <script>
    const LATAM = new Set(["AR","BO","BR","CL","CO","CR","CU","DO","EC","GT","HN","MX","NI","PA","PE","PY","UY","VE"]);
    const flag = cc => cc ? `<img class="flag" src="https://flagcdn.com/w40/${cc.toLowerCase()}.png"> ${cc}` : "--";

    // ---------- CISA ----------
    const cisa = { items: [], page: 0, pageSize: 5 };
    async function loadCisa() {
      const data = await (await fetch("kev_cisa.json")).json();
      cisa.items = data || [];
      renderCisa();
    }
    function renderCisa() {
      const tb = document.getElementById("cisa-body");
      tb.innerHTML = "";
      const start = cisa.page * cisa.pageSize;
      cisa.items.slice(start, start + cisa.pageSize).forEach(v => {
        tb.innerHTML += `<tr>
          <td>${v.fecha || "-"}</td>
          <td class="text-yellow-300">${v.cve || "-"}</td>
          <td>${v.vendor || "-"}</td>
          <td>${v.producto || "-"}</td>
          <td>${(v.descripcion || "").substring(0, 150)}...</td>
        </tr>`;
      });
    }
    document.getElementById("cisa-prev").onclick=()=>{if(cisa.page>0){cisa.page--;renderCisa();}};
    document.getElementById("cisa-next").onclick=()=>{if((cisa.page+1)*cisa.pageSize<cisa.items.length){cisa.page++;renderCisa();}};

    // ---------- CVEMON ----------
    const cvemon = { items: [], page:0, pageSize:5 };
    async function loadCvemon() {
      const data = await (await fetch("kev_cvemon.json")).json();
      cvemon.items = data || [];
      renderCvemon();
    }
    function renderCvemon(){
      const tb=document.getElementById("cvemon-body");
      tb.innerHTML="";
      const start=cvemon.page*cvemon.pageSize;
      cvemon.items.slice(start,start+cvemon.pageSize).forEach(i=>{
        tb.innerHTML+=`<tr>
          <td>${i.fecha || "-"}</td>
          <td class="text-yellow-300">${i.cve || "Sin CVE"}</td>
          <td>${(i.descripcion||"").substring(0,150)}...</td>
        </tr>`;
      });
    }
    document.getElementById("cvemon-prev").onclick=()=>{if(cvemon.page>0){cvemon.page--;renderCvemon();}};
    document.getElementById("cvemon-next").onclick=()=>{if((cvemon.page+1)*cvemon.pageSize<cvemon.items.length){cvemon.page++;renderCvemon();}};

    // ---------- INCIBE ----------
    const incibe={items:[],page:0,pageSize:5};
    async function loadIncibe(){
      const data=await (await fetch("kev_incibe.json")).json();
      incibe.items=data || [];
      renderIncibe();
    }
    function renderIncibe(){
      const tb=document.getElementById("incibe-body");
      tb.innerHTML="";
      const start=incibe.page*incibe.pageSize;
      incibe.items.slice(start,start+incibe.pageSize).forEach(i=>{
        tb.innerHTML+=`<tr>
          <td>${i.fecha || "-"}</td>
          <td class="text-yellow-300">${i.cve || "Sin CVE"}</td>
          <td>${(i.descripcion||"").substring(0,150)}...</td>
        </tr>`;
      });
    }
    document.getElementById("incibe-prev").onclick=()=>{if(incibe.page>0){incibe.page--;renderIncibe();}};
    document.getElementById("incibe-next").onclick=()=>{if((incibe.page+1)*incibe.pageSize<incibe.items.length){incibe.page++;renderIncibe();}};

    // ---------- Ransomware ----------
    const ransom={items:[],globalPage:0,latamPage:0,pageSize:5};
    async function loadRansom(){
      const data=await (await fetch("ransomware.json")).json();
      ransom.items=data.map(d=>({
        date:d.date||d.discovered||"",
        victim:d.victim||d.domain||"",
        country:(d.country||"").toUpperCase(),
        group:d.group||"",
        url:d.url||"#"
      }));
      renderRansom();
    }
    function renderRansom(){
      const g=document.getElementById("ransom-global");
      const l=document.getElementById("ransom-latam");
      g.innerHTML=""; l.innerHTML="";
      const startG=ransom.globalPage*ransom.pageSize;
      ransom.items.slice(startG,startG+ransom.pageSize).forEach(i=>{
        g.innerHTML+=`<tr><td>${i.date}</td><td><a href="${i.url}" class="underline">${i.victim}</a></td><td>${flag(i.country)}</td><td>${i.group}</td></tr>`;
      });
      const latamItems=ransom.items.filter(i=>LATAM.has(i.country));
      const startL=ransom.latamPage*ransom.pageSize;
      latamItems.slice(startL,startL+ransom.pageSize).forEach(i=>{
        l.innerHTML+=`<tr><td>${i.date}</td><td><a href="${i.url}" class="underline">${i.victim}</a></td><td>${flag(i.country)}</td><td>${i.group}</td></tr>`;
      });
    }
    document.getElementById("r-global-prev").onclick=()=>{if(ransom.globalPage>0){ransom.globalPage--;renderRansom();}};
    document.getElementById("r-global-next").onclick=()=>{if((ransom.globalPage+1)*ransom.pageSize<ransom.items.length){ransom.globalPage++;renderRansom();}};
    document.getElementById("r-latam-prev").onclick=()=>{if(ransom.latamPage>0){ransom.latamPage--;renderRansom();}};
    document.getElementById("r-latam-next").onclick=()=>{const latamItems=ransom.items.filter(i=>LATAM.has(i.country));if((ransom.latamPage+1)*ransom.pageSize<latamItems.length){ransom.latamPage++;renderRansom();}};

    // INIT
    loadCisa(); loadCvemon(); loadIncibe(); loadRansom();
  </script>
</body>
</html>
